# CI/CD æµæ°´çº¿ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

æœ¬é¡¹ç›®ä½¿ç”¨ä¸¤ä¸ªç‹¬ç«‹çš„ GitHub Actions å·¥ä½œæµæ¥ç®¡ç†æ„å»ºå’Œå‘å¸ƒæµç¨‹ï¼š

1. **Build Pipeline** (`build.yml`) - æ„å»ºæµæ°´çº¿
2. **Release Pipeline** (`release-process.yml`) - å‘å¸ƒæµæ°´çº¿

## ğŸ”¨ æ„å»ºæµæ°´çº¿ (Build Pipeline)

### è§¦å‘æ–¹å¼

#### è‡ªåŠ¨è§¦å‘
æ¨é€åˆ° `build` æˆ– `build-*` åˆ†æ”¯ï¼š

```bash
# æ–¹å¼ 1: åˆ›å»º build åˆ†æ”¯
git checkout -b build
git push origin build

# æ–¹å¼ 2: åˆ›å»ºå¸¦ç‰ˆæœ¬å·çš„ build åˆ†æ”¯ï¼ˆæ¨èï¼‰
git checkout -b build-v1.0.1
git push origin build-v1.0.1
```

#### æ‰‹åŠ¨è§¦å‘
åœ¨ GitHub Actions é¡µé¢æ‰‹åŠ¨è¿è¡Œï¼Œå¯æŒ‡å®šç‰ˆæœ¬å·ã€‚

### æ„å»ºæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. å‡†å¤‡æ„å»ºä¿¡æ¯     â”‚
â”‚  - æå–ç‰ˆæœ¬å·        â”‚
â”‚  - ç”Ÿæˆæ„å»ºæ—¶é—´      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. å¤šå¹³å°æ„å»º       â”‚
â”‚  - Linux (amd64/arm64) â”‚
â”‚  - macOS (amd64/arm64) â”‚
â”‚  - Windows (amd64)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. æµ‹è¯• & æ ¡éªŒ      â”‚
â”‚  - è¿è¡Œ --version   â”‚
â”‚  - ç”Ÿæˆ SHA256      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. ä¸Šä¼  Artifacts   â”‚
â”‚  - ä¿ç•™ 30 å¤©        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ„å»ºäº§ç‰©

æ„å»ºæˆåŠŸåï¼Œä¼šç”Ÿæˆä»¥ä¸‹æ–‡ä»¶å¹¶ä¸Šä¼ åˆ° GitHub Actions Artifactsï¼š

```
cursortoolset-linux-amd64
cursortoolset-linux-amd64.sha256
cursortoolset-linux-arm64
cursortoolset-linux-arm64.sha256
cursortoolset-darwin-amd64
cursortoolset-darwin-amd64.sha256
cursortoolset-darwin-arm64
cursortoolset-darwin-arm64.sha256
cursortoolset-windows-amd64.exe
cursortoolset-windows-amd64.exe.sha256
```

### ç‰ˆæœ¬å·è§„åˆ™

1. **ä»åˆ†æ”¯åæå–**ï¼ˆæ¨èï¼‰ï¼š
   ```bash
   # åˆ†æ”¯å: build-v1.0.1
   # æå–ç‰ˆæœ¬: v1.0.1
   git checkout -b build-v1.0.1
   ```

2. **ä» Git æ ‡ç­¾**ï¼š
   ```bash
   git tag v1.0.1
   # ç‰ˆæœ¬å·: v1.0.1
   ```

3. **æ‰‹åŠ¨æŒ‡å®š**ï¼ˆGitHub UI è§¦å‘æ—¶ï¼‰

4. **é»˜è®¤**ï¼š`dev-{commit-hash}`

## ğŸš€ å‘å¸ƒæµæ°´çº¿ (Release Pipeline)

### è§¦å‘æ–¹å¼

**ä»…æ”¯æŒæ‰‹åŠ¨è§¦å‘**ï¼Œåœ¨ GitHub Actions é¡µé¢è¿è¡Œï¼š

1. è¿›å…¥ `Actions` æ ‡ç­¾
2. é€‰æ‹© `Release Pipeline`
3. ç‚¹å‡» `Run workflow`
4. å¡«å†™å‚æ•°ï¼š
   - **version**: å‘å¸ƒç‰ˆæœ¬å·ï¼ˆå¦‚ `v1.0.1`ï¼‰
   - **build_branch**: Build åˆ†æ”¯åï¼ˆå¦‚ `build-v1.0.1`ï¼‰
   - **create_github_release**: æ˜¯å¦åˆ›å»º GitHub Releaseï¼ˆé»˜è®¤ `true`ï¼‰

### å‘å¸ƒæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. éªŒè¯å‚æ•°         â”‚
â”‚  - æ£€æŸ¥ç‰ˆæœ¬å·æ ¼å¼    â”‚
â”‚  - æ£€æŸ¥ build åˆ†æ”¯   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. åˆ›å»º Release åˆ†æ”¯â”‚
â”‚  - ReleaseLatest     â”‚
â”‚  - Release_v1.0.1    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. æ„å»º Release     â”‚
â”‚  - å¤šå¹³å°æ„å»º        â”‚
â”‚  - æ³¨å…¥ç‰ˆæœ¬ä¿¡æ¯      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. åˆ›å»º GitHub      â”‚
â”‚     Release          â”‚
â”‚  - åˆ›å»º Git Tag      â”‚
â”‚  - ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶    â”‚
â”‚  - ç”Ÿæˆ Release Notesâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Release åˆ†æ”¯è¯´æ˜

#### ReleaseLatest
- **ç”¨é€”**: ä¸€é”®å®‰è£…è„šæœ¬çš„å›ºå®šé“¾æ¥
- **æ›´æ–°**: æ¯æ¬¡å‘å¸ƒéƒ½æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
- **é“¾æ¥**: `https://github.com/{owner}/{repo}/tree/ReleaseLatest`

**ä¸€é”®å®‰è£…è„šæœ¬ä½¿ç”¨ ReleaseLatest**ï¼š
```bash
# Linux/macOS
curl -fsSL https://raw.githubusercontent.com/{owner}/{repo}/ReleaseLatest/install.sh | bash

# Windows
iwr -useb https://raw.githubusercontent.com/{owner}/{repo}/ReleaseLatest/install.ps1 | iex
```

#### Release_vX.Y.Z
- **ç”¨é€”**: å½’æ¡£ç‰¹å®šç‰ˆæœ¬çš„ä»£ç 
- **æ›´æ–°**: æ°¸ä¹…ä¿ç•™ï¼Œä¸ä¼šå˜æ›´
- **é“¾æ¥**: `https://github.com/{owner}/{repo}/tree/Release_v1.0.1`

### GitHub Release

å‘å¸ƒæµæ°´çº¿ä¼šåˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ GitHub Releaseï¼ŒåŒ…å«ï¼š

1. **Git Tag**: å¦‚ `v1.0.1`
2. **Release æ ‡é¢˜**: `CursorToolset v1.0.1`
3. **Release è¯´æ˜**:
   - å®‰è£…æ–¹å¼
   - æ ¡éªŒæ–¹æ³•
   - ç‰ˆæœ¬ä¿¡æ¯
   - ç›¸å…³é“¾æ¥
   - æ›´æ–°æ—¥å¿—
4. **é™„ä»¶**: æ‰€æœ‰å¹³å°çš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œæ ¡éªŒå’Œ

## ğŸ“‹ å®Œæ•´å‘å¸ƒæµç¨‹ç¤ºä¾‹

### ç¬¬ä¸€æ­¥ï¼šå¼€å‘å’Œæµ‹è¯•

```bash
# åœ¨ main åˆ†æ”¯å¼€å‘
git checkout main
# ... å¼€å‘ä»£ç  ...
git add .
git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½"
```

### ç¬¬äºŒæ­¥ï¼šåˆ›å»º Build åˆ†æ”¯

```bash
# åˆ›å»ºå¸¦ç‰ˆæœ¬å·çš„ build åˆ†æ”¯
git checkout -b build-v1.0.1
git push origin build-v1.0.1
```

**ç»“æœ**ï¼š
- è‡ªåŠ¨è§¦å‘ Build Pipeline
- 5-10 åˆ†é’Ÿåæ„å»ºå®Œæˆ
- äº§ç‰©ä¸Šä¼ åˆ° Artifacts

### ç¬¬ä¸‰æ­¥ï¼šéªŒè¯æ„å»º

1. è¿›å…¥ GitHub Actions æŸ¥çœ‹ Build Pipeline è¿è¡Œç»“æœ
2. æ£€æŸ¥æ‰€æœ‰å¹³å°æ„å»ºæ˜¯å¦æˆåŠŸ
3. ä¸‹è½½ Artifacts è¿›è¡Œæœ¬åœ°æµ‹è¯•ï¼ˆå¯é€‰ï¼‰

### ç¬¬å››æ­¥ï¼šæ‰§è¡Œå‘å¸ƒ

1. è¿›å…¥ GitHub Actions
2. é€‰æ‹© `Release Pipeline`
3. ç‚¹å‡» `Run workflow`
4. å¡«å†™å‚æ•°ï¼š
   ```
   version: v1.0.1
   build_branch: build-v1.0.1
   create_github_release: true
   ```
5. ç‚¹å‡» `Run workflow` å¼€å§‹å‘å¸ƒ

**ç»“æœ**ï¼š
- åˆ›å»º `ReleaseLatest` åˆ†æ”¯ï¼ˆæ›´æ–°ï¼‰
- åˆ›å»º `Release_v1.0.1` åˆ†æ”¯ï¼ˆå½’æ¡£ï¼‰
- åˆ›å»º GitHub Release `v1.0.1`
- ä¸Šä¼ æ‰€æœ‰äºŒè¿›åˆ¶æ–‡ä»¶

### ç¬¬äº”æ­¥ï¼šéªŒè¯å‘å¸ƒ

```bash
# æµ‹è¯•ä¸€é”®å®‰è£…è„šæœ¬ï¼ˆå¦‚æœæœ‰æµ‹è¯•ç¯å¢ƒï¼‰
curl -fsSL https://raw.githubusercontent.com/{owner}/{repo}/ReleaseLatest/install.sh | bash

# æ£€æŸ¥ç‰ˆæœ¬
cursortoolset --version
# è¾“å‡º: cursortoolset version v1.0.1 (built at ...)
```

### ç¬¬å…­æ­¥ï¼šæ›´æ–°ä¸»åˆ†æ”¯ï¼ˆå¯é€‰ï¼‰

```bash
# å°†å‘å¸ƒåˆ†æ”¯åˆå¹¶å› main
git checkout main
git merge build-v1.0.1
git push origin main

# æ¸…ç† build åˆ†æ”¯ï¼ˆå¯é€‰ï¼‰
git push origin --delete build-v1.0.1
git branch -d build-v1.0.1
```

## ğŸ”„ ç‰ˆæœ¬ç®¡ç†ç­–ç•¥

### ç‰ˆæœ¬å·è§„èŒƒ

éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼ˆSemantic Versioningï¼‰ï¼š

```
vMAJOR.MINOR.PATCH

ä¾‹å¦‚: v1.2.3
- MAJOR (1): é‡å¤§å˜æ›´ï¼Œå¯èƒ½ä¸å…¼å®¹
- MINOR (2): æ–°åŠŸèƒ½ï¼Œå‘åå…¼å®¹
- PATCH (3): Bug ä¿®å¤ï¼Œå‘åå…¼å®¹
```

### åˆ†æ”¯ç­–ç•¥

```
main                     # ä¸»åˆ†æ”¯ï¼Œç¨³å®šç‰ˆæœ¬
  â”‚
  â”œâ”€ feature/*          # åŠŸèƒ½åˆ†æ”¯
  â”‚
  â”œâ”€ build              # é€šç”¨æ„å»ºåˆ†æ”¯
  â”œâ”€ build-v1.0.0       # ç‰ˆæœ¬åŒ–æ„å»ºåˆ†æ”¯
  â”œâ”€ build-v1.0.1       # ç‰ˆæœ¬åŒ–æ„å»ºåˆ†æ”¯
  â”‚
  â”œâ”€ ReleaseLatest      # æœ€æ–°å‘å¸ƒï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰
  â”œâ”€ Release_v1.0.0     # ç‰ˆæœ¬å½’æ¡£ï¼ˆæ°¸ä¹…ä¿ç•™ï¼‰
  â””â”€ Release_v1.0.1     # ç‰ˆæœ¬å½’æ¡£ï¼ˆæ°¸ä¹…ä¿ç•™ï¼‰
```

### å‘å¸ƒå‘¨æœŸå»ºè®®

- **Patch ç‰ˆæœ¬**: æ¯å‘¨æˆ–æŒ‰éœ€ï¼ˆBug ä¿®å¤ï¼‰
- **Minor ç‰ˆæœ¬**: æ¯æœˆæˆ–æ¯å­£åº¦ï¼ˆæ–°åŠŸèƒ½ï¼‰
- **Major ç‰ˆæœ¬**: æ¯å¹´æˆ–é‡å¤§å˜æ›´æ—¶

## ğŸ› ï¸ æ•…éšœæ’é™¤

### é—®é¢˜ 1: Build Pipeline å¤±è´¥

**å¯èƒ½åŸå› **ï¼š
- ä»£ç ç¼–è¯‘é”™è¯¯
- æµ‹è¯•å¤±è´¥
- Go ä¾èµ–é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æŸ¥çœ‹ Actions æ—¥å¿—æ‰¾åˆ°å…·ä½“é”™è¯¯
2. åœ¨æœ¬åœ°è¿è¡Œ `go build` å’Œæµ‹è¯•
3. ä¿®å¤åé‡æ–°æ¨é€

### é—®é¢˜ 2: Release Pipeline éªŒè¯å¤±è´¥

**é”™è¯¯**: `Build åˆ†æ”¯ 'xxx' ä¸å­˜åœ¨`

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤ build åˆ†æ”¯å·²æ¨é€åˆ°è¿œç¨‹
2. ç¡®è®¤åˆ†æ”¯åæ‹¼å†™æ­£ç¡®
3. ç­‰å¾… Build Pipeline å®Œæˆ

### é—®é¢˜ 3: ç‰ˆæœ¬å·æ ¼å¼é”™è¯¯

**é”™è¯¯**: `ç‰ˆæœ¬å·æ ¼å¼ä¸æ­£ç¡®ï¼Œåº”ä¸º v1.0.1 æ ¼å¼`

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨æ­£ç¡®æ ¼å¼ï¼š`v1.0.1`ï¼ˆå°å†™ v + ä¸‰æ®µå¼ç‰ˆæœ¬å·ï¼‰

### é—®é¢˜ 4: GitHub Release åˆ›å»ºå¤±è´¥

**å¯èƒ½åŸå› **ï¼š
- Tag å·²å­˜åœ¨
- æƒé™ä¸è¶³

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. åˆ é™¤å·²å­˜åœ¨çš„ Tagï¼ˆå¦‚æœéœ€è¦ï¼‰:
   ```bash
   git tag -d v1.0.1
   git push origin :refs/tags/v1.0.1
   ```
2. æ£€æŸ¥ GitHub Token æƒé™

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### GitHub Actions æ—¥å¿—

æ¯ä¸ªæ­¥éª¤éƒ½æœ‰è¯¦ç»†æ—¥å¿—ï¼š
- ç‚¹å‡» Actions æ ‡ç­¾
- é€‰æ‹©å·¥ä½œæµè¿è¡Œ
- æŸ¥çœ‹æ¯ä¸ªæ­¥éª¤çš„è¾“å‡º

### æ„å»ºæ€»ç»“ (Summary)

å·¥ä½œæµå®Œæˆåä¼šç”Ÿæˆæ€»ç»“ï¼ŒåŒ…å«ï¼š
- æ„å»ºä¿¡æ¯ï¼ˆç‰ˆæœ¬ã€æ—¶é—´ã€åˆ†æ”¯ï¼‰
- æ„å»ºäº§ç‰©åˆ—è¡¨ï¼ˆå¹³å°ã€å¤§å°ã€æ ¡éªŒå’Œï¼‰
- ä¸‹ä¸€æ­¥æ“ä½œå»ºè®®

## ğŸ¯ æœ€ä½³å®è·µ

1. **æ„å»ºå‰æµ‹è¯•**
   ```bash
   # æœ¬åœ°æµ‹è¯•æ„å»º
   make build-all
   
   # æœ¬åœ°æµ‹è¯•
   ./cursortoolset --version
   ```

2. **å‘½åè§„èŒƒ**
   ```bash
   # æ¨èï¼šä½¿ç”¨ç‰ˆæœ¬å·ä½œä¸ºåˆ†æ”¯å
   build-v1.0.1
   
   # ä¸æ¨èï¼šæ¨¡ç³Šçš„åˆ†æ”¯å
   build
   my-build
   ```

3. **ç‰ˆæœ¬é€’å¢**
   - æ¯æ¬¡å‘å¸ƒé€’å¢ç‰ˆæœ¬å·
   - ä¸è¦é‡å¤ä½¿ç”¨ç‰ˆæœ¬å·

4. **ä¿ç•™æ„å»ºæ—¥å¿—**
   - Build Artifacts ä¿ç•™ 30 å¤©
   - Release Artifacts ä¿ç•™ 90 å¤©
   - GitHub Release æ°¸ä¹…ä¿ç•™

5. **æ–‡æ¡£æ›´æ–°**
   - å‘å¸ƒå‰æ›´æ–° CHANGELOG.md
   - æ›´æ–° README.mdï¼ˆå¦‚æœ‰é‡å¤§å˜æ›´ï¼‰

## ğŸ”— ç›¸å…³èµ„æº

- [GitHub Actions æ–‡æ¡£](https://docs.github.com/en/actions)
- [è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ](https://semver.org/lang/zh-CN/)
- [é¡¹ç›® README](./README.md)
- [ç‰ˆæœ¬æ§åˆ¶è¯´æ˜](./VERSION_CONTROL.md)

---

**æç¤º**: æ­¤ CI/CD æµæ°´çº¿ä½¿ç”¨ `github-action-toolset` çš„è§„åˆ™å’Œæœ€ä½³å®è·µæ„å»ºã€‚

