---
alwaysApply: true
---
# GitHub Issue 协作规则

## 概述

本项目使用 `github-issue` 工具进行跨项目协作。该工具提供标准化的 Issue 创建、解析和状态管理功能。

## 安装

```bash
cursortoolset install github-issue
```

## 环境配置

### 必需环境变量

| 变量 | 说明 |
|------|------|
| `<no value>` | GitHub Personal Access Token |

### Token 权限要求

- `repo` 或 `public_repo`：创建/关闭 Issue
- `gist`：创建 Gist 存储 payload

## 命令参考

### 1. 创建 Issue

```bash
github-issue create --repo <owner/repo> --type <type> --title <title> [options]
```

**参数：**
| 参数 | 必需 | 说明 |
|------|------|------|
| `--repo` | ✅ | 目标仓库，格式：`owner/repo` |
| `--type` | ✅ | Issue 类型（见下方类型列表） |
| `--title` | ✅ | Issue 标题 |
| `--payload` | ❌ | 详细内容文件路径（JSON 格式） |
| `--attach` | ❌ | 附件文件路径（可多次使用） |
| `--dry-run` | ❌ | 预览模式，不实际创建 |

**Issue 类型：**
- `feature-request` - 功能请求
- `bug-report` - Bug 报告
- `pack-register` - 包注册（CursorToolset）
- `pack-sync` - 包同步（CursorToolset）

**示例：**
```bash
# 创建功能请求
github-issue create \
  --repo shichao402/CursorColdStart \
  --type feature-request \
  --title "添加本地调试支持" \
  --payload request.json

# 预览模式
github-issue create \
  --repo shichao402/CursorColdStart \
  --type feature-request \
  --title "测试" \
  --dry-run
```

### 2. 列出 Issue

```bash
github-issue list [options]
```

**参数：**
| 参数 | 必需 | 说明 |
|------|------|------|
| `--status` | ❌ | 状态过滤：`pending`/`processing`/`processed`/`all`（默认 `pending`） |
| `--type` | ❌ | 类型过滤 |
| `--limit` | ❌ | 数量限制，默认 20 |
| `--format` | ❌ | 输出格式：`table`/`json`（默认 `table`） |

**示例：**
```bash
# 列出所有待处理的 issue
github-issue list

# 列出所有功能请求
github-issue list --type feature-request --status all

# JSON 格式输出
github-issue list --format json
```

### 3. 获取 Issue

```bash
github-issue get <issue-number> [options]
```

**参数：**
| 参数 | 必需 | 说明 |
|------|------|------|
| `<issue-number>` | ✅ | Issue 编号 |
| `--format` | ❌ | 输出格式：`json`/`yaml`/`text`（默认 `json`） |
| `--output` | ❌ | 输出到文件 |

**示例：**
```bash
# 获取 issue #123 的结构化数据
github-issue get 123

# 输出为 YAML 格式
github-issue get 123 --format yaml

# 保存到文件
github-issue get 123 --output issue-123.json
```

### 4. 更新 Issue 状态

```bash
github-issue update <issue-number> --status <status> [options]
```

**参数：**
| 参数 | 必需 | 说明 |
|------|------|------|
| `<issue-number>` | ✅ | Issue 编号 |
| `--status` | ✅ | 新状态：`processing`/`pending` |
| `--comment` | ❌ | 添加评论 |

**示例：**
```bash
# 标记为处理中
github-issue update 123 --status processing --comment "开始处理"

# 退回待处理
github-issue update 123 --status pending --comment "需要更多信息"
```

### 5. 关闭 Issue

```bash
github-issue close <issue-number> --result <result> [options]
```

**参数：**
| 参数 | 必需 | 说明 |
|------|------|------|
| `<issue-number>` | ✅ | Issue 编号 |
| `--result` | ✅ | 处理结果：`success`/`rejected` |
| `--comment` | ❌ | 处理说明 |

**示例：**
```bash
# 标记处理成功
github-issue close 123 --result success --comment "已添加到 v1.1.0"

# 标记拒绝
github-issue close 123 --result rejected --comment "不符合项目规范"
```

## AI 使用指南

### 何时使用此工具

1. **向其他项目提交请求** - 功能请求、Bug 报告
2. **处理收到的 Issue** - 获取、更新状态、关闭
3. **CursorToolset 包管理** - 注册新包、同步版本

### 工作流程

#### 提交请求到其他项目

```bash
# 1. 准备 payload 文件
cat > request.json << 'EOF'
{
  "description": "详细描述...",
  "motivation": "为什么需要这个功能...",
  "proposed_solution": "建议的实现方式..."
}
EOF

# 2. 创建 Issue
github-issue create \
  --repo target-owner/target-repo \
  --type feature-request \
  --title "功能标题" \
  --payload request.json
```

#### 处理收到的 Issue

```bash
# 1. 列出待处理的 Issue
github-issue list

# 2. 获取 Issue 详情
github-issue get 123

# 3. 标记为处理中
github-issue update 123 --status processing

# 4. 完成处理后关闭
github-issue close 123 --result success --comment "已完成"
```

### Payload 文件格式

#### 功能请求 (feature-request)

```json
{
  "description": "功能描述",
  "motivation": "需求背景",
  "proposed_solution": "建议方案",
  "alternatives": "备选方案（可选）",
  "additional_context": "其他信息（可选）"
}
```

#### Bug 报告 (bug-report)

```json
{
  "description": "问题描述",
  "steps_to_reproduce": ["步骤1", "步骤2"],
  "expected_behavior": "预期行为",
  "actual_behavior": "实际行为",
  "environment": {
    "os": "操作系统",
    "version": "软件版本"
  }
}
```

#### 包注册 (pack-register)

```json
{
  "package_url": "https://github.com/owner/repo",
  "description": "包描述",
  "keywords": ["关键词1", "关键词2"]
}
```

## 禁止行为

- ❌ 手动在 GitHub 网页创建 Issue（应使用工具保持格式一致）
- ❌ 不设置 `GITHUB_TOKEN` 环境变量
- ❌ 创建 Issue 时不指定类型
- ❌ 关闭 Issue 时不说明处理结果

## 必须遵守

- ✅ 使用 `github-issue` 命令创建标准化 Issue
- ✅ 创建前使用 `--dry-run` 预览
- ✅ 处理 Issue 时及时更新状态
- ✅ 关闭 Issue 时提供处理说明
- ✅ 保持 payload 文件格式规范
